/*
 * File: app/view/ui/newTicketForm.js
 *
 * This file was generated by Sencha Designer version 2.0.0.
 * http://www.sencha.com/products/designer/
 *
 * This file requires use of the Ext JS 4.0.x library, under independent license.
 * License of Sencha Designer does not include license for Ext JS 4.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('cstt.view.ui.newTicketForm', {
    extend: 'Ext.form.Panel',
    requires: [
        'cstt.view.contactRequestComboBox',
        'cstt.view.ticketTypeComboBox',
        'cstt.view.attachmentGrid'
    ],

    height: 590,
    itemId: 'newTicketForm',
    bodyPadding: 10,
    title: 'Neues Ticket anlegen...',
    couchDBDocID: null,
    autoScroll: true,
    anchor: '100%',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            defaults: {
                hideMode: 'offsets'
            },
            dockedItems: [
                {
                    xtype: 'toolbar',
                    itemId: 'bottomToolbar',
                    ui: 'footer',
                    dock: 'bottom',
                    items: [
                        {
                            xtype: 'button',
                            itemId: 'buttonSave',
                            text: 'Ticket anlegen',
                            action: 'save',
                            listeners: {
                                click: {
                                    fn: me.onSaveClick,
                                    scope: me
                                }
                            }
                        },
                        {
                            xtype: 'button',
                            hidden: true,
                            itemId: 'buttonUpdate',
                            text: 'Ticket speichern',
                            action: 'update',
                            listeners: {
                                click: {
                                    fn: me.onUpdateClick,
                                    scope: me
                                }
                            }
                        },
                        {
                            xtype: 'tbseparator'
                        },
                        {
                            xtype: 'button',
                            itemId: 'cancel',
                            text: 'Abbrechen',
                            listeners: {
                                click: {
                                    fn: me.onCancelClick,
                                    scope: me
                                }
                            }
                        }
                    ]
                }
            ],
            items: [
                {
                    xtype: 'container',
                    itemId: 'topContainer',
                    layout: {
                        type: 'column'
                    },
                    width: 1080,
                    items: [
                        {
                            xtype: 'panel',
                            itemId: 'leftContainer',
                            bodyBorder: false,
                            border: false,
                            width: 580,
                            items: [
                                {
                                    xtype: 'companyComboBox',
                                    itemId: 'companyComboBox',
                                    width: 420,
                                    name: 'customerDocID',
                                    labelWidth: 120,
                                    allowBlank: false,
                                    selectOnFocus: true,
                                    forceSelection: true,
                                    queryMode: 'local',
                                    typeAhead: true,
                                    listeners: {
                                        select: {
                                            fn: me.onCompanyComboBoxSelect,
                                            scope: me
                                        }
                                    }
                                },
                                {
                                    xtype: 'combobox',
                                    itemId: 'contactPersonComboBox',
                                    width: 420,
                                    name: 'contactDocID',
                                    fieldLabel: 'Kontaktperson',
                                    labelWidth: 120,
                                    allowBlank: false,
                                    emptyText: 'Kontaktperson auswählen',
                                    selectOnFocus: true,
                                    displayField: 'contactNameConvert',
                                    queryMode: 'local',
                                    store: 'contactToCompanyStore',
                                    typeAhead: true,
                                    valueField: '_id',
                                    listeners: {
                                        render: {
                                            fn: me.onContactPersonComboBoxRender,
                                            scope: me
                                        }
                                    }
                                },
                                {
                                    xtype: 'contactRequestComboBox',
                                    itemId: 'contactRequestComboBox',
                                    labelWidth: 120,
                                    store: 'contactRequestStore'
                                },
                                {
                                    xtype: 'ticketTypeComboBox',
                                    itemId: 'ticketTypeComboBox',
                                    labelWidth: 120,
                                    store: 'ticketTypeStore'
                                },                              
                                {
                                    xtype: 'textfield',
                                    width: 450,
                                    name: 'title',
                                    fieldLabel: 'Kurzbeschreibung',
                                    labelWidth: 120,
                                    allowBlank: false
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'status',
                                    name: 'status',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'owner',
                                    name: 'owner',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'lastEditorID',
                                    name: 'lastEditorID',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'type',
                                    name: 'type',
                                    value: 'ticket',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'ticketNumber',
                                    name: 'ticketNumber',
                                    fieldLabel: 'Label'
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            itemId: 'rightContainer',
                            width: 500,
                            items: [
                                {
                                    xtype: 'panel',
                                    frame: true,
                                    height: 210,
                                    layout: {
                                        type: 'column'
                                    },
                                    bodyPadding: 5,
                                    title: 'Informationen zum Kunden',
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            itemId: 'bottomToolbar',
                                            ui: 'footer',
                                            dock: 'bottom',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    iconCls: 'add',
                                                    text: 'Neue Version',
                                                    handler: function() {
                                                    	Ext.Msg.alert('Hinweis', 'Diese Funktion steht momentan noch nicht zur Verfügung.');
                                                    },
                                                    tooltip: 'Aktualisierung der Software eintragen ...'
                                                },
                                                {
                                                    xtype: 'tbseparator'
                                                },
                                                {
                                                    xtype: 'button',
                                                    itemId: 'versionOverviewButton',
                                                    iconCls: 'database_go',
                                                    text: 'Versionsübersicht',
                                                    tooltip: 'Zeigt die Versionsaktualisierungen vom Kunden ...',
                                                    listeners: {
                                                        click: {
                                                            fn: me.onVersionOverviewButtonClick,
                                                            scope: me
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    ],
                                    items: [
                                        {
                                            xtype: 'container',
                                            itemId: 'leftContainer',
                                            width: 180,
                                            items: [
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'ticketValueServerVersion',
                                                    name: 'serverVersion',
                                                    submitValue: false,
                                                    width: 120,
                                                    fieldLabel: 'Aktuelle Server-Version',
                                                    labelStyle: 'font-weight:bold;'
                                                },
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'ticketValueClientVersion',
                                                    name: 'clientVersion',
                                                    submitValue: false,
                                                    width: 120,
                                                    fieldLabel: 'Aktuelle Client-Version',
                                                    labelStyle: 'font-weight:bold;'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'container',
                                            width: 280,
                                            itemId: 'rightContainer',
                                            items: [
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'ticketValueEditionProduct',
                                                    width: 280,
                                                    submitValue: false,
                                                    fieldLabel: 'Edition',
                                                    labelStyle: 'font-weight: bold;'
                                                },
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'ticketValueAddOnsProduct',
                                                    width: 280,
                                                    submitValue: false,
                                                    fieldLabel: 'AddOns',
                                                    labelStyle: 'font-weight: bold;'
                                                },
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'ticketValueCustomerLicences',
                                                    width: 280,
                                                    submitValue: false,
                                                    fieldLabel: 'Lizenzen',
                                                    labelStyle: 'font-weight: bold;'
                                                },
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'ticketValueSupportUntilDate',
                                                    width: 280,
                                                    submitValue: false,
                                                    fieldLabel: 'Support bis',
                                                    labelStyle: 'font-weight: bold;'
                                                },
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'ticketValueSpecials',
                                                    width: 280,
                                                    submitValue: false,
                                                    fieldLabel: 'Besonderheiten',
                                                    labelStyle: 'font-weight: bold;'
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    xtype: 'container',
                    itemId: 'bottomContainer',
                    items: [
                        {
                            xtype: 'tabpanel',
                            border: 'false',
                            height: 300,
                            hidden: true,
                            itemId: 'tabPanelNewTicketForm',
                            activeTab: 0,
                            anchor: '100%',
                         	layout: {
                                type: 'fit'
                            },
                            deferredRender: false,
                            plain: true,
                            items: [
                                {
                                    xtype: 'panel',
                                    border: 'false',
                                    title: 'Beschreibung',
                                    tabConfig: {
                                        xtype: 'tab',
                                        tooltip: 'Beschreibung'
                                    },
                                    layout: {
		                                type: 'anchor'
		                            },
                                    height: 275,
                                    items: [
                                        {
                                            xtype: 'csttHtmlEditor',
                                            resizable: false,
                                            anchor: '100%',
                                            height: 275,
                                            style: 'background-color: white;',
                                            itemId: 'descriptionHTMLEditor',
                                            name: 'description',
                                            hideLabel: true
                                        }
                                    ]
                                },
                                {
                                    xtype: 'panel',
                                    height: 275,
                                    title: 'Dateianhänge',
                                    tabConfig: {
                                        xtype: 'tab',
                                        tooltip: 'Dateianhänge'
                                    },
                                    layout: 'anchor',
                                    items: [
                                        {
                                            xtype: 'attachmentGrid',
                                            height: 275,
                                            autoScroll: true,
                                    		overflow: 'auto',
                                            itemId: 'attachmentGridNewTicket',
                                            store: 'ticketAttachmentsStore'
                                        }
                                    ],
                                    listeners: {
		                                activate: {
		                                    fn: me.onAttachmentsActivate,
		                                    scope: me
		                                }
		                            }
                                }
                            ]
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    },

    onSaveClick: function(button, e, options) {
    },

    onUpdateClick: function(button, e, options) {
    },

    onCancelClick: function(button, e, options) {
    },

    onCompanyComboBoxSelect: function(field, value, options) {
    },

    onContactPersonComboBoxRender: function(abstractcomponent, options) {
    },

    onVersionOverviewButtonClick: function(button, e, options) {
    },
    
    onAttachmentsActivate: function(abstractcomponent, options) {
    }

});